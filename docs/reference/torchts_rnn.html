<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>RNN model for time series forecasting - torchts engine for parsnip API — torchts_rnn • torchts</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="RNN model for time series forecasting - torchts engine for parsnip API — torchts_rnn"><meta property="og:description" content="RNN model for time series forecasting - torchts engine for parsnip API"><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">torchts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/data-prepare-rnn.html">Preparing data for recurrent models</a>
    </li>
    <li>
      <a href="../articles/naming-convention.html">Naming convention</a>
    </li>
    <li>
      <a href="../articles/parsnip-api.html">parsnip API</a>
    </li>
    <li>
      <a href="../articles/torchts-api.html">torchts ready-to-use models API</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/krzjoa/torchts/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>RNN model for time series forecasting - <code>torchts</code> engine for <code>parsnip</code> API</h1>
    <small class="dont-index">Source: <a href="https://github.com/krzjoa/torchts/blob/HEAD/R/rnn-impl.R" class="external-link"><code>R/rnn-impl.R</code></a></small>
    <div class="hidden name"><code>torchts_rnn.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>RNN model for time series forecasting - <code>torchts</code> engine for <code>parsnip</code> API</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">torchts_rnn</span><span class="op">(</span>
  <span class="va">formula</span>,
  <span class="va">data</span>,
  learn_rate <span class="op">=</span> <span class="fl">0.001</span>,
  <span class="va">hidden_units</span>,
  dropout <span class="op">=</span> <span class="cn">FALSE</span>,
  timesteps <span class="op">=</span> <span class="fl">20</span>,
  horizon <span class="op">=</span> <span class="fl">1</span>,
  jump <span class="op">=</span> <span class="va">horizon</span>,
  rnn_layer <span class="op">=</span> <span class="va">nn_gru</span>,
  initial_layer_size <span class="op">=</span> <span class="cn">NULL</span>,
  optim <span class="op">=</span> <span class="fu"><a href="https://torch.mlverse.org/docs/reference/optim_adam.html" class="external-link">optim_adam</a></span><span class="op">(</span><span class="op">)</span>,
  validation <span class="op">=</span> <span class="cn">NULL</span>,
  stateful <span class="op">=</span> <span class="cn">FALSE</span>,
  batch_size <span class="op">=</span> <span class="fl">1</span>,
  epochs <span class="op">=</span> <span class="fl">10</span>,
  shuffle <span class="op">=</span> <span class="cn">TRUE</span>,
  scale <span class="op">=</span> <span class="cn">TRUE</span>,
  sample_frac <span class="op">=</span> <span class="fl">0.5</span>,
  loss_fn <span class="op">=</span> <span class="va">nnf_mae</span>,
  device <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>(<code>formula</code>) A formula describing, how to use the data</p></dd>
<dt>data</dt>
<dd><p>(<code>data.frame</code>) A input data.frame.</p></dd>
<dt>learn_rate</dt>
<dd><p>(<code>numeric</code>) Learning rate.</p></dd>
<dt>hidden_units</dt>
<dd><p>(<code>integer</code>) Number of hidden units.</p></dd>
<dt>dropout</dt>
<dd><p>(<code>logical</code>) Use dropout (default = FALSE).</p></dd>
<dt>timesteps</dt>
<dd><p>(<code>integer</code>) Number of timesteps used to produce a forecast.</p></dd>
<dt>horizon</dt>
<dd><p>(<code>integer</code>) Forecast horizon.</p></dd>
<dt>jump</dt>
<dd><p>(<code>integer</code>) Input window shift.</p></dd>
<dt>rnn_layer</dt>
<dd><p>(<code>nn_rnn_base</code>) A <code>torch</code> recurrent layer.</p></dd>
<dt>optim</dt>
<dd><p>(<code>function</code>) A function returning a <code>torch</code> optimizer (like <code>optim_adam</code>)
or R expression like <code>optim_adam(amsgrad = TRUE)</code>. Such expression will be handled and feed with
<code>params</code> and <code>lr</code> arguments.</p></dd>
<dt>validation</dt>
<dd><p>(<code>data.frame</code> or <code>numeric</code>) Validation dataset or percent of TODO.</p></dd>
<dt>stateful</dt>
<dd><p>(<code>logical</code> or <code>list</code>) Determine network behaviour: is stateful or not.</p></dd>
<dt>batch_size</dt>
<dd><p>(<code>integer</code>) Batch size.</p></dd>
<dt>epochs</dt>
<dd><p>(<code>integer</code>) Number of epochs to train the network.</p></dd>
<dt>shuffle</dt>
<dd><p>(<code>logical</code>) A dataloader argument - shuffle rows or not?</p></dd>
<dt>scale</dt>
<dd><p>(<code>logical</code> or <code>list</code>)</p></dd>
<dt>sample_frac</dt>
<dd><p>(<code>numeric</code>) A fraction of time series to be sampled.</p></dd>
<dt>loss_fn</dt>
<dd><p>(<code>function</code>) A <code>torch</code> loss function.</p></dd>
<dt>device</dt>
<dd><p>(<code>character</code>) A <code>torch</code> device.</p></dd>
</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://torch.mlverse.org/docs" class="external-link">torch</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/krzjoa/torchts" class="external-link">torchts</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/timetk" class="external-link">timetk</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Preparing a dataset</span></span>
<span class="r-in"><span class="va">tiny_m5_sample</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="va">tiny_m5</span> <span class="op"><a href="https://torch.mlverse.org/docs/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">item_id</span> <span class="op">==</span> <span class="st">"FOODS_3_586"</span>, <span class="va">store_id</span> <span class="op">==</span> <span class="st">"CA_1"</span><span class="op">)</span> <span class="op"><a href="https://torch.mlverse.org/docs/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/timetk/man/tk_summary_diagnostics.html" class="external-link">tk_summary_diagnostics</a></span><span class="op">(</span><span class="va">tiny_m5_sample</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> tk_augment_timeseries_signature(): Using the following .date_var variable: date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n.obs start      end        units scale tzone diff.minimum diff.q1 diff.median</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">1</span>913 2011-01-29 2016-04-24 days  day   UTC          <span style="text-decoration: underline;">86</span>400   <span style="text-decoration: underline;">86</span>400       <span style="text-decoration: underline;">86</span>400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 3 more variables: diff.mean &lt;dbl&gt;, diff.q3 &lt;dbl&gt;, diff.maximum &lt;dbl&gt;</span></span>
<span class="r-in"><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">tiny_m5_sample</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rows: 1,913</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Columns: 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ item_id      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "FOODS_3_586", "FOODS_3_586", "FOODS_3_586", "FOODS_3_586…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ dept_id      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "FOODS_3", "FOODS_3", "FOODS_3", "FOODS_3", "FOODS_3", "F…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ cat_id       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "FOODS", "FOODS", "FOODS", "FOODS", "FOODS", "FOODS", "FO…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ store_id     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "CA_1", "CA_1", "CA_1", "CA_1", "CA_1", "CA_1", "CA_1", "…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ state_id     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "CA", "CA", "CA", "CA", "CA", "CA", "CA", "CA", "CA", "CA…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ value        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 42, 36, 30, 23, 27, 34, 30, 59, 54, 37, 22, 38, 33, 38, 5…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ date         <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2011-01-29, 2011-01-30, 2011-01-31, 2011-02-01, 2011-02-…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ wm_yr_wk     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 11101, 11101, 11101, 11101, 11101, 11101, 11101, 11102, 1…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ weekday      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday", "…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ wday         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ month        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ year         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 2011, 2011, 2011, 2011, 2011, 2011, 2011, 2011, 2011, 201…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ event_name_1 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "", "", "", "", "", "", "", "", "SuperBowl", "", "", "", …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ event_type_1 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "", "", "", "", "", "", "", "", "Sporting", "", "", "", "…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ event_name_2 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "", "", "", "", "", "", "", "", "", "", "", "", "", "", "…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ event_type_2 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "", "", "", "", "", "", "", "", "", "", "", "", "", "", "…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ snap         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ sell_price   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.48, 1.48, 1.48, 1.48, 1.48, 1.48, 1.48, 1.48, 1.48, 1.4…</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">TIMESTEPS</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">data_split</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/pkg/timetk/man/time_series_split.html" class="external-link">time_series_split</a></span><span class="op">(</span></span>
<span class="r-in">    <span class="va">tiny_m5_sample</span>, <span class="va">date</span>,</span>
<span class="r-in">    initial <span class="op">=</span> <span class="st">"4 years"</span>,</span>
<span class="r-in">    assess  <span class="op">=</span> <span class="st">"1 year"</span>,</span>
<span class="r-in">    lag     <span class="op">=</span> <span class="va">TIMESTEPS</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Training</span></span>
<span class="r-in"><span class="va">rnn_model</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu">torchts_rnn</span><span class="op">(</span></span>
<span class="r-in">    <span class="va">value</span> <span class="op">~</span> <span class="va">date</span> <span class="op">+</span> <span class="va">value</span> <span class="op">+</span> <span class="va">sell_price</span> <span class="op">+</span> <span class="va">wday</span>,</span>
<span class="r-in">    data <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">training</a></span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span>,</span>
<span class="r-in">    hidden_units <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">    timesteps <span class="op">=</span> <span class="va">TIMESTEPS</span>,</span>
<span class="r-in">    horizon   <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">    epochs <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">    batch_size <span class="op">=</span> <span class="fl">32</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Categorical variables found (1): wday</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Training started</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in (function (self, other) {    .Call("_torch_cpp_torch_method_matmul_self_Tensor_other_Tensor",         PACKAGE = "torchpkg", self, other)})(self = &lt;pointer: 0x562646169260&gt;, other = &lt;pointer: 0x562638edaad0&gt;):</span> mat1 and mat2 shapes cannot be multiplied (640x4 and 3x6)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> Exception raised from addmm_impl_cpu_ at ../aten/src/ATen/native/LinearAlgebra.cpp:939 (most recent call first):</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;) + 0x69 (0x7f5fc2c5e1d9 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libc10.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;) + 0xd2 (0x7f5fc2c5a812 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libc10.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #2: &lt;unknown function&gt; + 0x11848a3 (0x7f5f1b8048a3 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libtorch_cpu.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #3: at::native::mm_cpu_out(at::Tensor const&amp;, at::Tensor const&amp;, at::Tensor&amp;) + 0x100 (0x7f5f1b805e40 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libtorch_cpu.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #4: at::native::mm_cpu(at::Tensor const&amp;, at::Tensor const&amp;) + 0x7e (0x7f5f1b805fae in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libtorch_cpu.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #5: &lt;unknown function&gt; + 0x1b17e13 (0x7f5f1c197e13 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libtorch_cpu.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #6: at::Tensor c10::Dispatcher::redispatch&lt;at::Tensor, at::Tensor const&amp;, at::Tensor const&amp;&gt;(c10::TypedOperatorHandle&lt;at::Tensor (at::Tensor const&amp;, at::Tensor const&amp;)&gt; const&amp;, c10::DispatchKeySet, at::Tensor const&amp;, at::Tensor const&amp;) const + 0x86 (0x7f5f1c14fdb6 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libtorch_cpu.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #7: at::redispatch::mm(c10::DispatchKeySet, at::Tensor const&amp;, at::Tensor const&amp;) + 0x72 (0x7f5f1bfd7bb2 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libtorch_cpu.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #8: &lt;unknown function&gt; + 0x33c2e41 (0x7f5f1da42e41 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libtorch_cpu.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #9: &lt;unknown function&gt; + 0x33c31c6 (0x7f5f1da431c6 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libtorch_cpu.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #10: at::Tensor::mm(at::Tensor const&amp;) const + 0x137 (0x7f5f1c4f4367 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libtorch_cpu.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #11: &lt;unknown function&gt; + 0x118bcfe (0x7f5f1b80bcfe in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libtorch_cpu.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #12: at::native::matmul(at::Tensor const&amp;, at::Tensor const&amp;) + 0x4a (0x7f5f1b80c37a in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libtorch_cpu.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #13: &lt;unknown function&gt; + 0x1cc85f3 (0x7f5f1c3485f3 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libtorch_cpu.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #14: at::Tensor::matmul(at::Tensor const&amp;) const + 0x137 (0x7f5f1c4f4077 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/./libtorch_cpu.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #15: _lantern_Tensor_matmul_tensor_tensor + 0x46 (0x7f5fc32eaac6 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/deps/liblantern.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #16: cpp_torch_method_matmul_self_Tensor_other_Tensor(XPtrTorchTensor, XPtrTorchTensor) + 0x35 (0x7f5fc3de17a5 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/libs/torchpkg.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #17: _torch_cpp_torch_method_matmul_self_Tensor_other_Tensor + 0xa2 (0x7f5fc3b8ea92 in /home/krzysztof/R/x86_64-pc-linux-gnu-library/4.1/torch/libs/torchpkg.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #18: &lt;unknown function&gt; + 0xf751c (0x7f5fd33da51c in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #19: &lt;unknown function&gt; + 0xf7a65 (0x7f5fd33daa65 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #20: &lt;unknown function&gt; + 0x132ba1 (0x7f5fd3415ba1 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #21: Rf_eval + 0x88 (0x7f5fd3430948 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #22: &lt;unknown function&gt; + 0x14f80f (0x7f5fd343280f in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #23: Rf_applyClosure + 0x1a2 (0x7f5fd3433702 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #24: Rf_eval + 0x2af (0x7f5fd3430b6f in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #25: &lt;unknown function&gt; + 0xc2bcd (0x7f5fd33a5bcd in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #26: &lt;unknown function&gt; + 0x132ba1 (0x7f5fd3415ba1 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #27: Rf_eval + 0x88 (0x7f5fd3430948 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #28: &lt;unknown function&gt; + 0x14f80f (0x7f5fd343280f in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #29: Rf_applyClosure + 0x1a2 (0x7f5fd3433702 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #30: &lt;unknown function&gt; + 0x13b296 (0x7f5fd341e296 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #31: Rf_eval + 0x88 (0x7f5fd3430948 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #32: &lt;unknown function&gt; + 0x14f80f (0x7f5fd343280f in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #33: Rf_applyClosure + 0x1a2 (0x7f5fd3433702 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #34: &lt;unknown function&gt; + 0x13b296 (0x7f5fd341e296 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #35: Rf_eval + 0x88 (0x7f5fd3430948 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #36: &lt;unknown function&gt; + 0x14f80f (0x7f5fd343280f in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #37: Rf_applyClosure + 0x1a2 (0x7f5fd3433702 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #38: Rf_eval + 0x2af (0x7f5fd3430b6f in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #39: &lt;unknown function&gt; + 0x1514f3 (0x7f5fd34344f3 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #40: Rf_eval + 0x57b (0x7f5fd3430e3b in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #41: &lt;unknown function&gt; + 0x14f80f (0x7f5fd343280f in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #42: Rf_applyClosure + 0x1a2 (0x7f5fd3433702 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #43: &lt;unknown function&gt; + 0x13b296 (0x7f5fd341e296 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #44: Rf_eval + 0x88 (0x7f5fd3430948 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #45: &lt;unknown function&gt; + 0x14f80f (0x7f5fd343280f in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #46: Rf_applyClosure + 0x1a2 (0x7f5fd3433702 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #47: Rf_eval + 0x2af (0x7f5fd3430b6f in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #48: &lt;unknown function&gt; + 0x1514f3 (0x7f5fd34344f3 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #49: Rf_eval + 0x57b (0x7f5fd3430e3b in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #50: &lt;unknown function&gt; + 0x14f80f (0x7f5fd343280f in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #51: Rf_applyClosure + 0x1a2 (0x7f5fd3433702 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #52: Rf_eval + 0x2af (0x7f5fd3430b6f in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #53: &lt;unknown function&gt; + 0x14e3dc (0x7f5fd34313dc in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #54: Rf_eval + 0x39f (0x7f5fd3430c5f in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #55: &lt;unknown function&gt; + 0x14e3dc (0x7f5fd34313dc in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #56: &lt;unknown function&gt; + 0x14e888 (0x7f5fd3431888 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #57: &lt;unknown function&gt; + 0x13925c (0x7f5fd341c25c in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #58: Rf_eval + 0x88 (0x7f5fd3430948 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #59: &lt;unknown function&gt; + 0x14e3dc (0x7f5fd34313dc in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #60: Rf_eval + 0x5f8 (0x7f5fd3430eb8 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #61: &lt;unknown function&gt; + 0x11b305 (0x7f5fd33fe305 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #62: &lt;unknown function&gt; + 0x132ba1 (0x7f5fd3415ba1 in /usr/lib/R/lib/libR.so)</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> frame #63: Rf_eval + 0x88 (0x7f5fd3430948 in /usr/lib/R/lib/libR.so)</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Prediction</span></span>
<span class="r-in"><span class="va">cleared_new_data</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">testing</a></span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span> <span class="op"><a href="https://torch.mlverse.org/docs/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="clear_outcome.html">clear_outcome</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">value</span>, <span class="va">TIMESTEPS</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">forecast</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rnn_model</span>, <span class="va">cleared_new_data</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in predict(rnn_model, cleared_new_data):</span> object 'rnn_model' not found</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://krzjoa.github.io" class="external-link">Krzysztof Joachimiak</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

