<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>General interface to recurrent neural network models — rnn • torchts</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="General interface to recurrent neural network models — rnn"><meta property="og:description" content="General interface to recurrent neural network models"><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">torchts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/data-prepare-rnn.html">Preparing data for recurrent models</a>
    </li>
    <li>
      <a href="../articles/naming-convention.html">Naming convention</a>
    </li>
    <li>
      <a href="../articles/parsnip-api.html">parsnip API</a>
    </li>
    <li>
      <a href="../articles/torchts-api.html">torchts ready-to-use models API</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/krzjoa/torchts/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>General interface to recurrent neural network models</h1>
    <small class="dont-index">Source: <a href="https://github.com/krzjoa/torchts/blob/HEAD/R/rnn-parsnip.R" class="external-link"><code>R/rnn-parsnip.R</code></a></small>
    <div class="hidden name"><code>rnn.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>General interface to recurrent neural network models</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">rnn</span><span class="op">(</span>
  mode <span class="op">=</span> <span class="st">"regression"</span>,
  timesteps <span class="op">=</span> <span class="cn">NULL</span>,
  horizon <span class="op">=</span> <span class="fl">1</span>,
  learn_rate <span class="op">=</span> <span class="fl">0.01</span>,
  epochs <span class="op">=</span> <span class="fl">50</span>,
  hidden_units <span class="op">=</span> <span class="cn">NULL</span>,
  dropout <span class="op">=</span> <span class="cn">NULL</span>,
  batch_size <span class="op">=</span> <span class="fl">32</span>,
  scale <span class="op">=</span> <span class="cn">TRUE</span>,
  shuffle <span class="op">=</span> <span class="cn">FALSE</span>,
  jump <span class="op">=</span> <span class="fl">1</span>,
  sample_frac <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mode</dt>
<dd><p>(<code>character</code>) Model mode, default: 'regression'.</p></dd>
<dt>timesteps</dt>
<dd><p>(<code>integer</code>) Number of timesteps to look back.</p></dd>
<dt>horizon</dt>
<dd><p>(<code>integer</code>) Forecast horizon.</p></dd>
<dt>learn_rate</dt>
<dd><p>(<code>numeric</code> or <code>dials::learn_rate</code>) Learning rate.</p></dd>
<dt>epochs</dt>
<dd><p>(<code>integer</code> or <code>dials::epochs</code>) Number of epochs.</p></dd>
<dt>hidden_units</dt>
<dd><p>(<code>integer</code>) Number of hidden units.</p></dd>
<dt>dropout</dt>
<dd><p>(<code>logical</code> or <code>dials::dropout</code>) Flag to use dropout.</p></dd>
<dt>batch_size</dt>
<dd><p>(<code>integer</code>) Batch size.</p></dd>
<dt>scale</dt>
<dd><p>(<code>logical</code>) Scale input features.</p></dd>
<dt>shuffle</dt>
<dd><p>(<code>logical</code>) Shuffle examples during the training (default: FALSE).</p></dd>
<dt>jump</dt>
<dd><p>(<code>integer</code>) Input window shift.</p></dd>
<dt>sample_frac</dt>
<dd><p>(<code>numeric</code>) A percent of subsamples used for training.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This is a <code>parsnip</code> API to the recurent network models. For now the only
available engine is <code>torchts_rnn</code>.</p>
    </div>
    <div id="categorical-features">
    <h2>Categorical features</h2>
    

<p>Categorical features are detected automatically - if a column of your input data (defined in the formula)
is <code>logical</code>, <code>character</code>, <code>factor</code> or <code>integer</code>.</p>
    </div>
    <div id="empty-model">
    <h2>Empty model</h2>
    

<p>Neural networks, unlike many other models (e.g. linear models) can return values
before any training epoch ended. It's because every neural networks model starts with
"random" parameters, which are gradually tuned in the following iterations according to the
Gradient Descent algorithm.</p>
<p>If you'd like to get a non-trained model, simply set <code>epochs = 0</code>.
You still have to "fit" the model to stick the standard <code>parsnip</code>'s API procedure.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/krzjoa/torchts" class="external-link">torchts</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://parsnip.tidymodels.org" class="external-link">parsnip</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsample.tidymodels.org" class="external-link">rsample</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Univariate time series</span></span>
<span class="r-in"><span class="va">tarnow_temp</span> <span class="op">&lt;-</span></span>
<span class="r-in"> <span class="va">weather_pl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in"> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">station</span> <span class="op">==</span> <span class="st">"TARNÓW"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in"> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">date</span>, temp <span class="op">=</span> <span class="va">tmax_daily</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">data_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">initial_time_split</a></span><span class="op">(</span><span class="va">tarnow_temp</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> `in_id` must be a positive integer vector.</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">rnn_model</span> <span class="op">&lt;-</span></span>
<span class="r-in">   <span class="fu">rnn</span><span class="op">(</span></span>
<span class="r-in">     timesteps <span class="op">=</span> <span class="fl">20</span>,</span>
<span class="r-in">     horizon <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">     epochs <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">     hidden_units <span class="op">=</span> <span class="fl">32</span></span>
<span class="r-in">   <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">rnn_model</span> <span class="op">&lt;-</span></span>
<span class="r-in">   <span class="va">rnn_model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">   <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">temp</span> <span class="op">~</span> <span class="va">date</span>, data <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">training</a></span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Engine set to `torchts`.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in analysis(x):</span> object 'data_split' not found</span>
<span class="r-in"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://krzjoa.github.io" class="external-link">Krzysztof Joachimiak</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

