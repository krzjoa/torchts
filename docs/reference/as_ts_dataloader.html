<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Quick shortcut to create a torch dataloader based on the given dataset — as_ts_dataloader • torchts</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Quick shortcut to create a torch dataloader based on the given dataset — as_ts_dataloader"><meta property="og:description" content="Quick shortcut to create a torch dataloader based on the given dataset"><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">torchts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/data-prepare-rnn.html">Preparing data for recurrent models</a>
    </li>
    <li>
      <a href="../articles/naming-convention.html">Naming convention</a>
    </li>
    <li>
      <a href="../articles/parsnip-api.html">parsnip API</a>
    </li>
    <li>
      <a href="../articles/torchts-api.html">torchts ready-to-use models API</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/krzjoa/torchts/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Quick shortcut to create a torch dataloader based on the given dataset</h1>
    <small class="dont-index">Source: <a href="https://github.com/krzjoa/torchts/blob/HEAD/R/as-ts-dataloder.R" class="external-link"><code>R/as-ts-dataloder.R</code></a></small>
    <div class="hidden name"><code>as_ts_dataloader.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Quick shortcut to create a torch dataloader based on the given dataset</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">as_ts_dataloader</span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">formula</span>,
  index <span class="op">=</span> <span class="cn">NULL</span>,
  key <span class="op">=</span> <span class="cn">NULL</span>,
  predictors <span class="op">=</span> <span class="cn">NULL</span>,
  outcomes <span class="op">=</span> <span class="cn">NULL</span>,
  categorical <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">timesteps</span>,
  horizon <span class="op">=</span> <span class="fl">1</span>,
  sample_frac <span class="op">=</span> <span class="fl">1</span>,
  scale <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">batch_size</span>,
  shuffle <span class="op">=</span> <span class="cn">FALSE</span>,
  jump <span class="op">=</span> <span class="fl">1</span>,
  drop_last <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>(<code>data.frame</code>) An input data.frame object with.
For now only <strong>single</strong> data frames are handled with no categorical features.</p></dd>
<dt>formula</dt>
<dd><p>(<code>formula</code>) A formula describing, how to use the data</p></dd>
<dt>index</dt>
<dd><p>(<code>character</code>) The index column name.</p></dd>
<dt>key</dt>
<dd><p>(<code>character</code>) The key column name(s). Use only if formula was not specified.</p></dd>
<dt>predictors</dt>
<dd><p>(<code>character</code>) Input variable names. Use only if formula was not specified.</p></dd>
<dt>outcomes</dt>
<dd><p>(<code>character</code>) Target variable names. Use only if formula was not specified.</p></dd>
<dt>categorical</dt>
<dd><p>(<code>character</code>) Categorical features.</p></dd>
<dt>timesteps</dt>
<dd><p>(<code>integer</code>) The time series chunk length.</p></dd>
<dt>horizon</dt>
<dd><p>(<code>integer</code>) Forecast horizon.</p></dd>
<dt>sample_frac</dt>
<dd><p>(<code>numeric</code>) Sample a fraction of rows (default: 1, i.e.: all the rows).</p></dd>
<dt>scale</dt>
<dd><p>(<code>logical</code> or <code>list</code>) Scale feature columns. Logical value or two-element list.
with values (mean, std)</p></dd>
<dt>batch_size</dt>
<dd><p>(<code>numeric</code>) Batch size.</p></dd>
<dt>shuffle</dt>
<dd><p>(<code>logical</code>) Shuffle examples.</p></dd>
<dt>drop_last</dt>
<dd><p>(<code>logical</code>) Set to TRUE to drop the last incomplete batch,
if the dataset size is not divisible by the batch size.
If FALSE and the size of dataset is not divisible by the batch size,
then the last batch will be smaller. (default: TRUE)</p></dd>
</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsample.tidymodels.org" class="external-link">rsample</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">suwalki_temp</span> <span class="op">&lt;-</span></span>
<span class="r-in">   <span class="va">weather_pl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">station</span> <span class="op">==</span> <span class="st">"SWK"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">date</span>, temp <span class="op">=</span> <span class="va">tmax_daily</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Splitting on training and test</span></span>
<span class="r-in"><span class="va">data_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">initial_time_split</a></span><span class="op">(</span><span class="va">suwalki_temp</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">train_dl</span> <span class="op">&lt;-</span></span>
<span class="r-in"> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">training</a></span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in"> <span class="fu">as_ts_dataloader</span><span class="op">(</span><span class="va">temp</span> <span class="op">~</span> <span class="va">date</span>, timesteps <span class="op">=</span> <span class="fl">20</span>, horizon <span class="op">=</span> <span class="fl">10</span>, batch_size <span class="op">=</span> <span class="fl">32</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">train_dl</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;dataloader&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Public:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     .auto_collation: active binding</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     .dataset_kind: map</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     .has_getbatch: FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     .index_sampler: active binding</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     .iter: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     .length: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     batch_sampler: utils_sampler_batch, utils_sampler, R6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     batch_size: 32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     clone: function (deep = FALSE) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     collate_fn: function (batch) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dataset: ts_dataset, dataset, R6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     drop_last: TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     generator: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     initialize: function (dataset, batch_size = 1, shuffle = FALSE, sampler = NULL, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     multiprocessing_context: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     num_workers: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pin_memory: FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sampler: utils_sampler_sequential, utils_sampler, R6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timeout: -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     worker_globals: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     worker_init_fn: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     worker_packages: NULL</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://torch.mlverse.org/docs/reference/dataloader_next.html" class="external-link">dataloader_next</a></span><span class="op">(</span><span class="fu"><a href="https://torch.mlverse.org/docs/reference/dataloader_make_iter.html" class="external-link">dataloader_make_iter</a></span><span class="op">(</span><span class="va">train_dl</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in dataloader_next(dataloader_make_iter(train_dl)):</span> could not find function "dataloader_next"</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://krzjoa.github.io" class="external-link">Krzysztof Joachimiak</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

