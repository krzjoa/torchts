---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# torchts

<!-- badges: start -->
[![CRAN status](https://www.r-pkg.org/badges/version/torchts)](https://CRAN.R-project.org/package=torchts)
[![Travis build status](https://travis-ci.com/krzjoa/torchts.svg?branch=master)](https://travis-ci.com/krzjoa/torchts)
[![AppVeyor build status](https://ci.appveyor.com/api/projects/status/github/krzjoa/torchts?branch=master&svg=true)](https://ci.appveyor.com/project/krzjoa/torchts)
[![Codecov test coverage](https://codecov.io/gh/krzjoa/torchts/branch/master/graph/badge.svg)](https://codecov.io/gh/krzjoa/torchts?branch=master)
[!["Buy Me A Coffee"](https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png)](https://www.buymeacoffee.com/kjoachimiak)
<!-- badges: end -->

> Time series models with torch

## Installation

You can install the released version of torchts from [CRAN](https://CRAN.R-project.org) with:

The development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("krzjoa/torchts")
```
## Usage

## parsnip models

```{r parsnip.api}
library(torchts)
library(torch)
library(rsample)
library(dplyr, warn.conflicts = FALSE)
library(parsnip)
library(timetk)

tarnow_temp <- 
  weather_pl %>% 
  filter(station == "TRN") %>% 
  select(date, tmax_daily)

# Splitting on training and test
data_split <- 
  time_series_split(
    tarnow_temp, date, 
    initial = "18 years",
    assess  = "2 years", 
    lag     = 20
  )

# Training 
rnn_model <- 
  rnn(epochs = 3, hidden_units = 32) %>% 
  fit(tmax_daily ~ date, 
      data = training(data_split))

prediction <-
  rnn_model %>%
  predict(new_data = testing(data_split))

```

### Transforming data.frames to tensors

In `as_tensor` function we can specify columns, that are used to 
create a tensor out of the input `data.frame`. Listed column names 
are only used to determine dimension sizes - they are removed after that
and are not present in the final tensor.

```{r example}
data("mts-examples", package="MTS")

dim(ibmspko)
head(ibmspko)

monthly_returns <- 
  ibmspko %>% 
  as_tensor(date)

dim(monthly_returns)
monthly_returns[1:6, ]
```
